/*!
 * AngularJS Material Design
 * https://github.com/angular/material
 * @license MIT
 * v1.1.10-master-82d51e3b6
 */
goog.provide("ngmaterial.components.autocomplete"),goog.require("ngmaterial.components.icon"),goog.require("ngmaterial.components.virtualRepeat"),goog.require("ngmaterial.core"),angular.module("material.components.autocomplete",["material.core","material.components.icon","material.components.virtualRepeat"]),MdAutocompleteCtrl.$inject=["$scope","$element","$mdUtil","$mdConstant","$mdTheming","$window","$animate","$rootElement","$attrs","$q","$log","$mdLiveAnnouncer","$document"],angular.module("material.components.autocomplete").controller("MdAutocompleteCtrl",MdAutocompleteCtrl);var ITEM_HEIGHT=48,MAX_ITEMS=5,MENU_PADDING=8,INPUT_PADDING=2;function MdAutocompleteCtrl(m,p,h,t,n,e,o,i,g,r,l,a,c){var u,d,s,f=this,$=m.itemsExpr.split(/ in /i),C=$[1],x=null,v={},b=!1,A=[],M=!1,T=0,w=null,I=null,y=h.debounce(function(){f.hidden||S()}),D=c[0];u="hidden",d=function(e,t){!e&&t?(S(),Q(!0,N.Count|N.Selected),x&&(h.disableScrollAround(x.ul),w=function(e){function t(e){e.preventDefault()}return e.on("wheel",t),e.on("touchmove",t),function(){e.off("wheel",t),e.off("touchmove",t)}}(angular.element(x.wrap)))):e&&!t&&(h.enableScrolling(),w&&(w(),w=null))},s=!0,Object.defineProperty(f,u,{get:function(){return s},set:function(e){var t=s;d(s=e,t)}}),f.scope=m,f.parent=m.$parent,f.itemName=$[0],f.matches=[],f.loading=!1,f.hidden=!0,f.index=null,f.id=h.nextUid(),f.isDisabled=null,f.isRequired=null,f.isReadonly=null,f.hasNotFound=!1,f.selectedMessage=m.selectedMessage||"selected",f.keydown=function(e){switch(e.keyCode){case t.KEY_CODE.DOWN_ARROW:if(f.loading)return;e.stopPropagation(),e.preventDefault(),f.index=Math.min(f.index+1,f.matches.length-1),Z(),Q(!1,N.Selected);break;case t.KEY_CODE.UP_ARROW:if(f.loading)return;e.stopPropagation(),e.preventDefault(),f.index=f.index<0?f.matches.length-1:Math.max(0,f.index-1),Z(),Q(!1,N.Selected);break;case t.KEY_CODE.TAB:if(P(),f.hidden||f.loading||f.index<0||f.matches.length<1)return;Y(f.index);break;case t.KEY_CODE.ENTER:if(f.hidden||f.loading||f.index<0||f.matches.length<1)return;if(z())return;e.stopPropagation(),e.preventDefault(),Y(f.index);break;case t.KEY_CODE.ESCAPE:if(e.preventDefault(),!(V("blur")||!f.hidden||f.loading||V("clear")&&m.searchText))return;e.stopPropagation(),X(),m.searchText&&V("clear")&&J(),f.hidden=!0,V("blur")&&function(e){e&&(M=b=!1);x.input.blur()}(!0)}},f.blur=function(e){M=!1,b||(f.hidden=U(),ie("ngBlur",{$event:e}))},f.focus=function(e){M=!0,G()&&K()&&ne();f.hidden=U(),ie("ngFocus",{$event:e})},f.clear=function(){X(),J()},f.select=Y,f.listEnter=function(){b=!0},f.listLeave=P,f.mouseUp=function(){x.input.focus()},f.getCurrentDisplayValue=W,f.registerSelectedItemWatcher=function(e){-1===A.indexOf(e)&&A.push(e)},f.unregisterSelectedItemWatcher=function(e){var t=A.indexOf(e);-1!==t&&A.splice(t,1)},f.notFoundVisible=te,f.loadingIsVisible=function(){return f.loading&&!z()},f.positionDropdown=S;var E,N={Count:1,Selected:2};return h.initOptionalProperties(m,g,{searchText:"",selectedItem:null,clearButton:!1}),n(p),E=parseInt(m.delay,10)||0,g.$observe("disabled",function(e){f.isDisabled=h.parseAttributeBoolean(e,!1)}),g.$observe("required",function(e){f.isRequired=h.parseAttributeBoolean(e,!1)}),g.$observe("readonly",function(e){f.isReadonly=h.parseAttributeBoolean(e,!1)}),m.$watch("searchText",E?h.debounce(O,E):O),m.$watch("selectedItem",k),angular.element(e).on("resize",y),m.$on("$destroy",L),void h.nextTick(function(){var e;e=function(){var e,t;for(e=p;e.length&&(t=e.attr("md-autocomplete-snap"),!angular.isDefined(t));e=e.parent());if(e.length)return{snap:e[0],wrap:"width"===t.toLowerCase()?e[0]:p.find("md-autocomplete-wrap")[0]};var n=p.find("md-autocomplete-wrap")[0];return{snap:n,wrap:n}}(),(x={main:p[0],scrollContainer:p[0].querySelector(".md-virtual-repeat-container"),scroller:p[0].querySelector(".md-virtual-repeat-scroller"),ul:p.find("ul")[0],input:p.find("input")[0],wrap:e.wrap,snap:e.snap,root:D.body}).li=x.ul.getElementsByTagName("li"),x.$=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=angular.element(e[n]));return t}(x),I=x.$.input.controller("ngModel"),x.$.root.length&&(n(x.$.scrollContainer),x.$.scrollContainer.detach(),x.$.root.append(x.$.scrollContainer),o.pin&&o.pin(x.$.scrollContainer,i)),m.autofocus&&p.on("focus",H),m.ariaDescribedBy&&x.input.setAttribute("aria-describedby",m.ariaDescribedBy)});function R(){m.requireMatch&&I&&I.$setValidity("md-require-match",!!m.selectedItem||!m.searchText)}function S(){if(!x)return h.nextTick(S,!1,m);var e,t=(m.dropdownItems||MAX_ITEMS)*ITEM_HEIGHT,n=x.wrap.getBoundingClientRect(),o=x.snap.getBoundingClientRect(),i=x.root.getBoundingClientRect(),l=o.bottom-i.top,a=i.bottom-o.top,r=n.left-i.left,c=n.width,u=function(){var e=0,t=p.find("md-input-container");if(t.length){var n=t.find("input");e=t.prop("offsetHeight"),e-=n.prop("offsetTop"),e-=n.prop("offsetHeight"),e+=t.prop("offsetTop")}return e}(),d=m.dropdownPosition;if(d||(d=a<l&&i.height-l-MENU_PADDING<t?"top":"bottom"),g.mdFloatingLabel&&(r+=INPUT_PADDING,c-=2*INPUT_PADDING),e={left:r+"px",minWidth:c+"px",maxWidth:Math.max(n.right-i.left,i.right-n.left)-MENU_PADDING+"px"},"top"===d)e.top="auto",e.bottom=a+"px",e.maxHeight=Math.min(t,n.top-i.top-MENU_PADDING)+"px";else{var s=i.bottom-n.bottom-MENU_PADDING+h.getViewportTop();e.top=l-u+"px",e.bottom="auto",e.maxHeight=Math.min(t,s)+"px"}x.$.scrollContainer.css(e),h.nextTick(function(){var e=x.scrollContainer.getBoundingClientRect(),t={};e.right>i.right-MENU_PADDING&&(t.left=n.right-e.width+"px");x.$.scrollContainer.css(t)},!1)}function H(){x.input.focus()}function L(){if(f.hidden||h.enableScrolling(),angular.element(e).off("resize",y),x){angular.forEach(["ul","scroller","scrollContainer","input"],function(e){x.$[e].remove()})}}function P(){M||f.hidden||x.input.focus(),b=!1,f.hidden=U()}function k(o,i){R(),o?_(o).then(function(e){var t,n;m.searchText=e,t=o,n=i,A.forEach(function(e){e(t,n)})}):i&&m.searchText&&_(i).then(function(e){angular.isString(m.searchText)&&e.toString().toLowerCase()===m.searchText.toLowerCase()&&(m.searchText="")}),o!==i&&angular.isFunction(m.itemChange)&&m.itemChange(q(m.selectedItem))}function O(t,n){f.index=m.autoselect?0:-1,t!==n&&(R(),_(m.selectedItem).then(function(e){t!==e&&(m.selectedItem=null,t!==n&&angular.isFunction(m.textChange)&&m.textChange(),K()?ne():(F(!(f.matches=[])),Q(!1,N.Count)))}))}function B(){return angular.isNumber(m.minLength)?m.minLength:1}function _(e){return r.when((t=e,(t&&m.itemText?m.itemText(q(t)):null)||e)).then(function(e){return e&&!angular.isString(e)&&l.warn("md-autocomplete: Could not resolve display value to a string. Please check the `md-item-text` attribute."),e});var t}function q(e){if(e){var t={};return f.itemName&&(t[f.itemName]=e),t}}function F(e){f.loading!==e&&(f.loading=e),f.hidden=U()}function U(){return!function(){{if(f.isReadonly)return!1;if(!G())return!1}return K()&&j()||te()}()}function G(){return!(f.loading&&!j())&&(!z()&&!!M)}function V(e){return!m.escapeOptions||-1!==m.escapeOptions.toLowerCase().indexOf(e)}function j(){return!!f.matches.length}function z(){return!!f.scope.selectedItem}function W(){return _(f.matches[f.index])}function K(){return(m.searchText||"").length>=B()}function Y(e){h.nextTick(function(){_(f.matches[e]).then(function(e){var t=x.$.input.controller("ngModel");a.announce(e+" "+f.selectedMessage,"assertive"),t.$setViewValue(e),t.$render()}).finally(function(){m.selectedItem=f.matches[e],F(!1)})},!1)}function X(){f.index=0,f.matches=[]}function J(){F(!0),m.searchText="";var e=D.createEvent("CustomEvent");e.initCustomEvent("change",!0,!0,{value:""}),x.input.dispatchEvent(e),x.input.blur(),m.searchText="",x.input.focus()}function Q(e,t){var n=e?"polite":"assertive",o=[];t&N.Selected&&-1!==f.index&&o.push(W()),t&N.Count&&o.push(r.resolve(function(){switch(f.matches.length){case 0:return"There are no matches available.";case 1:return"There is 1 match available.";default:return"There are "+f.matches.length+" matches available."}}())),r.all(o).then(function(e){a.announce(e.join(" "),n)})}function Z(){if(x.li[0]){var e=x.li[0].offsetHeight,t=e*f.index,n=t+e,o=x.scroller.clientHeight,i=x.scroller.scrollTop;t<i?ee(t):i+o<n&&ee(n-o)}}function ee(e){x.$.scrollContainer.controller("mdVirtualRepeatContainer").scrollTo(e)}function te(){var e=(f.scope.searchText||"").length;return f.hasNotFound&&!j()&&(!f.loading||0!==T)&&e>=B()&&(M||b)&&!z()}function ne(){var e=m.searchText||"",t=e.toLowerCase();!m.noCache&&v[t]?oe(v[t]):function(t){var e=m.$parent.$eval(C),n=t.toLowerCase(),o=angular.isArray(e),i=!!e.then;function l(e){v[n]=e,(t||"")===(m.searchText||"")&&oe(e)}o?l(e):i&&(a=e,a&&(a=r.when(a),T++,F(!0),h.nextTick(function(){a.then(l).finally(function(){0==--T&&F(!1)})},!0,m)));var a}(e),f.hidden=U()}function oe(e){var n,t,o;f.matches=e,f.hidden=U(),f.loading&&F(!1),m.selectOnMatch&&(n=m.searchText,t=f.matches,o=t[0],1===t.length&&_(o).then(function(e){var t=n===e;m.matchInsensitive&&!t&&(t=n.toLowerCase()===e.toLowerCase()),t&&Y(0)})),S(),Q(!0,N.Count)}function ie(e,t){g[e]&&m.$parent.$eval(g[e],t||{})}}function MdAutocomplete(u){return{controller:"MdAutocompleteCtrl",controllerAs:"$mdAutocompleteCtrl",scope:{inputName:"@mdInputName",inputMinlength:"@mdInputMinlength",inputMaxlength:"@mdInputMaxlength",searchText:"=?mdSearchText",selectedItem:"=?mdSelectedItem",itemsExpr:"@mdItems",itemText:"&mdItemText",placeholder:"@placeholder",ariaDescribedBy:"@?ariaDescribedby",noCache:"=?mdNoCache",requireMatch:"=?mdRequireMatch",selectOnMatch:"=?mdSelectOnMatch",matchInsensitive:"=?mdMatchCaseInsensitive",itemChange:"&?mdSelectedItemChange",textChange:"&?mdSearchTextChange",minLength:"=?mdMinLength",delay:"=?mdDelay",autofocus:"=?mdAutofocus",floatingLabel:"@?mdFloatingLabel",autoselect:"=?mdAutoselect",menuClass:"@?mdMenuClass",menuContainerClass:"@?mdMenuContainerClass",inputClass:"@?mdInputClass",inputId:"@?mdInputId",escapeOptions:"@?mdEscapeOptions",dropdownItems:"=?mdDropdownItems",dropdownPosition:"@?mdDropdownPosition",clearButton:"=?mdClearButton",selectedMessage:"@?mdSelectedMessage"},compile:function(e,n){var o=e.find("input");return["md-select-on-focus","md-no-asterisk","ng-trim","ng-pattern"].forEach(function(e){var t=n[n.$normalize(e)];null!==t&&o.attr(e,t)}),function(e,t,n,o){o.hasNotFound=!!t.attr("md-has-not-found"),angular.isDefined(n.mdClearButton)||e.floatingLabel||(e.clearButton=!0)}},template:function(n,e){var t,o,i=(t=n.find("md-not-found").detach(),(o=t.length?t.html():"")?'<li ng-if="$mdAutocompleteCtrl.notFoundVisible()"                         md-autocomplete-parent-scope>'+o+"</li>":""),l=function(){var e=n.find("md-item-template").detach(),t=e.length?e.html():n.html();e.length||n.empty();return"<md-autocomplete-parent-scope md-autocomplete-replace>"+t+"</md-autocomplete-parent-scope>"}(),a=n.html(),r=e.tabindex,c=e.mdMenuContainerClass?" "+e.mdMenuContainerClass:"";return i&&n.attr("md-has-not-found",!0),n.attr("tabindex","-1"),"        <md-autocomplete-wrap            ng-class=\"{ 'md-whiteframe-z1': !floatingLabel,                         'md-menu-showing': !$mdAutocompleteCtrl.hidden,                         'md-show-clear-button': !!clearButton }\">          "+(e.mdFloatingLabel?'            <md-input-container ng-if="floatingLabel">              <label>{{floatingLabel}}</label>              <input type="search"                  '+(null!=r?'tabindex="'+r+'"':"")+'                  id="{{ inputId || \'fl-input-\' + $mdAutocompleteCtrl.id }}"                  name="{{inputName}}"                  ng-class="::inputClass"                  autocomplete="off"                  ng-required="$mdAutocompleteCtrl.isRequired"                  ng-readonly="$mdAutocompleteCtrl.isReadonly"                  ng-minlength="inputMinlength"                  ng-maxlength="inputMaxlength"                  ng-disabled="$mdAutocompleteCtrl.isDisabled"                  ng-model="$mdAutocompleteCtrl.scope.searchText"                  ng-model-options="{ allowInvalid: true }"                  ng-keydown="$mdAutocompleteCtrl.keydown($event)"                  ng-blur="$mdAutocompleteCtrl.blur($event)"                  ng-focus="$mdAutocompleteCtrl.focus($event)"                  aria-owns="ul-{{$mdAutocompleteCtrl.id}}"                  aria-label="{{floatingLabel}}"                  aria-autocomplete="list"                  role="combobox"                  aria-haspopup="true"                  aria-activedescendant=""                  aria-expanded="{{!$mdAutocompleteCtrl.hidden}}"/>              <div md-autocomplete-parent-scope md-autocomplete-replace>'+a+"</div>            </md-input-container>":'            <input type="search"                '+(null!=r?'tabindex="'+r+'"':"")+'                id="{{ inputId || \'input-\' + $mdAutocompleteCtrl.id }}"                name="{{inputName}}"                ng-class="::inputClass"                ng-if="!floatingLabel"                autocomplete="off"                ng-required="$mdAutocompleteCtrl.isRequired"                ng-disabled="$mdAutocompleteCtrl.isDisabled"                ng-readonly="$mdAutocompleteCtrl.isReadonly"                ng-minlength="inputMinlength"                ng-maxlength="inputMaxlength"                ng-model="$mdAutocompleteCtrl.scope.searchText"                ng-keydown="$mdAutocompleteCtrl.keydown($event)"                ng-blur="$mdAutocompleteCtrl.blur($event)"                ng-focus="$mdAutocompleteCtrl.focus($event)"                placeholder="{{placeholder}}"                aria-owns="ul-{{$mdAutocompleteCtrl.id}}"                aria-label="{{placeholder}}"                aria-autocomplete="list"                role="combobox"                aria-haspopup="true"                aria-activedescendant=""                aria-expanded="{{!$mdAutocompleteCtrl.hidden}}"/>')+'          <button type="button" aria-label="Clear Input" tabindex="-1" ng-if="clearButton && $mdAutocompleteCtrl.scope.searchText" ng-click="$mdAutocompleteCtrl.clear($event)"><md-icon md-svg-src="'+u.mdClose+'"></md-icon></button>          <md-progress-linear              class="'+(e.mdFloatingLabel?"md-inline":"")+'"              ng-if="$mdAutocompleteCtrl.loadingIsVisible()"              md-mode="indeterminate"></md-progress-linear>          <md-virtual-repeat-container              md-auto-shrink              md-auto-shrink-min="1"              ng-mouseenter="$mdAutocompleteCtrl.listEnter()"              ng-mouseleave="$mdAutocompleteCtrl.listLeave()"              ng-mouseup="$mdAutocompleteCtrl.mouseUp()"              ng-hide="$mdAutocompleteCtrl.hidden"              class="md-autocomplete-suggestions-container md-whiteframe-z1'+c+'"              ng-class="{ \'md-not-found\': $mdAutocompleteCtrl.notFoundVisible() }"              role="presentation">            <ul class="md-autocomplete-suggestions"                ng-class="::menuClass"                id="ul-{{$mdAutocompleteCtrl.id}}">              <li md-virtual-repeat="item in $mdAutocompleteCtrl.matches"                  ng-class="{ selected: $index === $mdAutocompleteCtrl.index }"                  ng-click="$mdAutocompleteCtrl.select($index)"                  md-extra-name="$mdAutocompleteCtrl.itemName">                  '+l+"                  </li>"+i+"            </ul>          </md-virtual-repeat-container>        </md-autocomplete-wrap>"}}}function MdAutocompleteItemScopeDirective(e,d){return{restrict:"AE",compile:function(e,t,u){return function(n,t,e){var o,i,l=n.$mdAutocompleteCtrl,a=l.parent.$new(),r=l.itemName;function c(e,t){a[t]=n[e],n.$watch(e,function(e){d.nextTick(function(){a[t]=e})})}c("$index","$index"),c("item",r),i=o=!1,n.$watch(function(){i||o||(o=!0,n.$$postDigest(function(){i||a.$digest(),o=i=!1}))}),a.$watch(function(){i=!0}),u(a,function(e){t.after(e)})}},terminal:!0,transclude:"element"}}function MdHighlightCtrl(e,t,n,o){this.$scope=e,this.$element=t,this.$attrs=n,this.$document=o,this.regex=null}function MdHighlight(n,o){return{terminal:!0,controller:"MdHighlightCtrl",compile:function(e,t){var i=o(t.mdHighlightText),l=n(e.html());return function(e,t,n,o){o.init(i,l)}}}}MdAutocomplete.$inject=["$$mdSvgRegistry"],angular.module("material.components.autocomplete").directive("mdAutocomplete",MdAutocomplete),MdAutocompleteItemScopeDirective.$inject=["$compile","$mdUtil"],angular.module("material.components.autocomplete").directive("mdAutocompleteParentScope",MdAutocompleteItemScopeDirective),MdHighlightCtrl.$inject=["$scope","$element","$attrs","$document"],angular.module("material.components.autocomplete").controller("MdHighlightCtrl",MdHighlightCtrl),MdHighlightCtrl.prototype.init=function(t,n){this.flags=this.$attrs.mdHighlightFlags||"",this.unregisterFn=this.$scope.$watch(function(e){return{term:t(e),contentText:n(e)}}.bind(this),this.onRender.bind(this),!0),this.$element.on("$destroy",this.unregisterFn)},MdHighlightCtrl.prototype.onRender=function(e,t){var n=e.contentText;null!==this.regex&&e.term===t.term||(this.regex=this.createRegex(e.term,this.flags)),e.term?this.applyRegex(n):this.$element.text(n)},MdHighlightCtrl.prototype.applyRegex=function(e){var t=this.resolveTokens(e);this.$element.empty(),t.forEach(function(e){if(e.isMatch){var t=angular.element('<span class="highlight">').text(e.text);this.$element.append(t)}else this.$element.append(this.$document[0].createTextNode(e))}.bind(this))},MdHighlightCtrl.prototype.resolveTokens=function(o){var i=[],n=0;return o.replace(this.regex,function(e,t){l(n,t),i.push({text:e,isMatch:!0}),n=t+e.length}),l(n),i;function l(e,t){var n=o.slice(e,t);n&&i.push(n)}},MdHighlightCtrl.prototype.createRegex=function(e,t){var n="",o="",i=this.sanitizeRegex(e);return 0<=t.indexOf("^")&&(n="^"),0<=t.indexOf("$")&&(o="$"),new RegExp(n+i+o,t.replace(/[$^]/g,""))},MdHighlightCtrl.prototype.sanitizeRegex=function(e){return e&&e.toString().replace(/[\\^$*+?.()|{}[\]]/g,"\\$&")},MdHighlight.$inject=["$interpolate","$parse"],angular.module("material.components.autocomplete").directive("mdHighlightText",MdHighlight),ngmaterial.components.autocomplete=angular.module("material.components.autocomplete");